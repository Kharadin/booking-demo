{"ast":null,"code":"var _jsxFileName = \"/Users/dimetrius/Documents/BookingApp/client/src/components/reserve/Reserve.jsx\",\n    _s = $RefreshSig$();\n\nimport { faCircleXmark } from \"@fortawesome/free-solid-svg-icons\";\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\nimport axios from \"axios\";\nimport { isLastDayOfMonth } from \"date-fns\";\nimport { useContext, useState } from \"react\";\nimport { useNavigate } from \"react-router-dom\";\nimport { SearchContext } from \"../../context/SearchContext\";\nimport useFetch from \"../../hooks/useFetch\";\nimport \"./reserve.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst Reserve = _ref => {\n  _s();\n\n  var _roomData$photos;\n\n  let {\n    setOpen,\n    hotelId,\n    roomId\n  } = _ref;\n  const [selectedRooms, setSelectedRooms] = useState([]); // const {data, loading, error } = useFetch(`/hotels/room/${hotelId}`)\n\n  const {\n    data: roomData,\n    loading: roomLoading,\n    error: roomError\n  } = useFetch(`/rooms/${roomId}`); // const { dates }= useContext(SearchContext)\n\n  const dates = JSON.parse(localStorage.getItem(\"dates\"));\n  console.log(dates);\n\n  const getDatesInRange = (startDate, endDate) => {\n    const start = new Date(startDate);\n    const end = new Date(endDate); // \"we don't need them, but they can stay in any case\"\n\n    const date = new Date(start.getTime());\n    console.log(date);\n    let list = [];\n\n    while (date <= end) {\n      list.push(new Date(date).getTime());\n      date.setDate(date.getDate() + 1);\n    }\n\n    return list;\n  };\n\n  const allDates = getDatesInRange(dates[0].startDate, dates[0].endDate);\n\n  const isAvailable = roomNumber => {\n    const isFound = roomNumber.unavailableDates.some(date => allDates.includes(new Date(date).getTime()));\n    return !isFound;\n  };\n\n  const handleSelect = e => {\n    const checked = e.target.checked;\n    const value = e.target.value;\n    setSelectedRooms(checked ? [...selectedRooms, value] : selectedRooms.filter(item => item !== value));\n  };\n\n  console.log(selectedRooms);\n  const navigate = useNavigate();\n\n  const handleClick = async () => {\n    try {\n      await Promise.all(selectedRooms.map(roomId => {\n        const res = axios.put(`/rooms/availability/${roomId}`, {\n          dates: allDates\n        });\n        return res.data;\n      }));\n      setOpen(false);\n      navigate('/');\n    } catch (err) {}\n  };\n\n  const handleRoomPhotoOpen = i => {};\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"reserve\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"roomWrapper\",\n      children: [/*#__PURE__*/_jsxDEV(FontAwesomeIcon, {\n        icon: faCircleXmark,\n        className: \"rClose\",\n        onClick: () => setOpen(false)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"roomHeader\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"roomTitle\",\n          children: roomData.title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 20\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"roomDesc\",\n          children: roomData.desc\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 20\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"roomPrice\",\n          children: [\"Price per night: \", roomData.price]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 20\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"maxPeople\",\n          children: [\"Max people: \", roomData.maxPeople]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 20\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"roomImages\",\n        children: (_roomData$photos = roomData.photos) === null || _roomData$photos === void 0 ? void 0 : _roomData$photos.map((photo, i) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"roomImgWrapper\",\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            onClick: () => handleRoomPhotoOpen(i),\n            src: photo,\n            alt: \"\",\n            className: \"roomImg\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 27\n          }, this)\n        }, i, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 25\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"roomDetails\",\n        children: roomData.details\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"roomBooking\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rmBookingHeading\",\n          children: \"Check availability and book your rooms: \"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"rSelectRooms\",\n          children: roomData.roomNumbers\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 34\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleClick,\n        className: \"rButton\",\n        children: \"Reserve Now!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 89,\n    columnNumber: 5\n  }, this);\n};\n\n_s(Reserve, \"surJRebP94s4wrPRstn5lUF5FDo=\", false, function () {\n  return [useFetch, useNavigate];\n});\n\n_c = Reserve;\nexport default Reserve;\n\nvar _c;\n\n$RefreshReg$(_c, \"Reserve\");","map":{"version":3,"names":["faCircleXmark","FontAwesomeIcon","axios","isLastDayOfMonth","useContext","useState","useNavigate","SearchContext","useFetch","Reserve","setOpen","hotelId","roomId","selectedRooms","setSelectedRooms","data","roomData","loading","roomLoading","error","roomError","dates","JSON","parse","localStorage","getItem","console","log","getDatesInRange","startDate","endDate","start","Date","end","date","getTime","list","push","setDate","getDate","allDates","isAvailable","roomNumber","isFound","unavailableDates","some","includes","handleSelect","e","checked","target","value","filter","item","navigate","handleClick","Promise","all","map","res","put","err","handleRoomPhotoOpen","i","title","desc","price","maxPeople","photos","photo","details","roomNumbers"],"sources":["/Users/dimetrius/Documents/BookingApp/client/src/components/reserve/Reserve.jsx"],"sourcesContent":["import { faCircleXmark } from \"@fortawesome/free-solid-svg-icons\"\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\"\nimport axios from \"axios\"\nimport { isLastDayOfMonth } from \"date-fns\"\nimport { useContext, useState } from \"react\"\nimport { useNavigate } from \"react-router-dom\"\nimport { SearchContext } from \"../../context/SearchContext\"\nimport useFetch from \"../../hooks/useFetch\"\nimport \"./reserve.css\"\n\nconst Reserve = ({setOpen, hotelId, roomId}) => {\n\n    const [selectedRooms, setSelectedRooms] = useState([]);\n\n   // const {data, loading, error } = useFetch(`/hotels/room/${hotelId}`)\n\n   const {data: roomData, loading: roomLoading, error: roomError} = useFetch(`/rooms/${roomId}`);\n\n    \n    // const { dates }= useContext(SearchContext)\n    const dates = JSON.parse(localStorage.getItem(\"dates\"))\n    console.log (dates)\n\n      const getDatesInRange = (startDate, endDate) => {\n        const start = new Date (startDate)\n        const end = new Date (endDate)\n        // \"we don't need them, but they can stay in any case\"\n\n          const date = new Date(start.getTime());\n          console.log(date)\n\n          let list = []\n\n          while(date <= end) {\n            list.push(new Date(date).getTime())\n            date.setDate(date.getDate()+1)\n          }\n\n          return list\n      }\n\n    const allDates = (getDatesInRange(dates[0].startDate, dates[0].endDate))\n\n    const isAvailable = (roomNumber)=> {\n      const isFound = roomNumber.unavailableDates.some(date=> allDates.includes(new Date(date).getTime())\n      )\n      return !isFound;\n    } ; \n\n\n     const handleSelect = (e)=> {\n          const checked = e.target.checked\n          const value= e.target.value\n          setSelectedRooms(\n                    checked ? \n                      [...selectedRooms, value]:\n                       selectedRooms.filter((item)=> item !==value)\n\n                    );\n      };\n      \n      console.log(selectedRooms)\n   \n      const navigate =useNavigate()\n   \n      const handleClick= async () => {\n        try {\n             \n         await Promise.all(\n            selectedRooms.map(roomId=>{\n              const res = axios.put(`/rooms/availability/${roomId}`, \n               {dates: allDates});\n              return res.data\n            })\n          );\n          setOpen(false)\n          navigate('/')\n          \n        } catch (err) {\n\n        }\n    };\n\n   const handleRoomPhotoOpen= (i)=> {\n\n   }\n      \n  return (\n    <div className=\"reserve\">\n      <div className=\"roomWrapper\">\n\n          <FontAwesomeIcon icon={faCircleXmark} className=\"rClose\" onClick={()=>setOpen(false)} / >\n          {/* <span>Select your rooms:</span> */}\n       \n              \n                <div className=\"roomHeader\">\n\n                   <h1 className=\"roomTitle\">{roomData.title}</h1>\n                   <span className=\"roomDesc\">{roomData.desc}</span>\n                   <span className=\"roomPrice\">Price per night: {roomData.price}</span>\n                   <span className=\"maxPeople\">Max people: {roomData.maxPeople}</span>\n                </div>\n                <div className=\"roomImages\">\n                          \n                        {roomData.photos?.map((photo, i) => (\n                        <div className=\"roomImgWrapper\" key={i}>\n                          <img\n                            onClick={() => handleRoomPhotoOpen(i)}\n                            src={photo}\n                            alt=\"\"\n                            className=\"roomImg\"\n                          />\n                        </div>\n                      ))}\n                </div>\n              \n                <div className=\"roomDetails\">\n                        {roomData.details}\n                </div>\n                <div className=\"roomBooking\">\n                    <div className=\"rmBookingHeading\">Check availability and book your rooms: </div>\n                         \n                                 <div className=\"rSelectRooms\">\n                                  {roomData.roomNumbers}\n                                </div> \n               \n                </div>\n             \n                \n          \n          <button onClick={handleClick} className=\"rButton\">Reserve Now!</button>\n\n      </div>\n    </div>\n  )\n}\n\nexport default Reserve;\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}